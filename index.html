<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>G3 Cloud - Login</title>
<style>
    body { background: #000; color: #fff; font-family: sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin:0;}
    .login-container { background:#111; padding:40px; border-radius:15px; width:100%; max-width:400px; text-align:center; box-shadow:0 0 20px rgba(0,255,204,0.4);}
    h1 { color:#00ffcc; margin-bottom:5px; }
    p.slogan { color:#aaa; margin-bottom:25px; font-size:0.9rem; }
    input { width:100%; padding:12px; margin:10px 0; border-radius:8px; border:1px solid #333; background:#000; color:#fff; }
    input:focus { outline:none; border-color:#00ffcc; box-shadow:0 0 10px rgba(0,255,204,0.5);}
    button { width:100%; padding:12px; margin-top:15px; border:none; border-radius:8px; background:linear-gradient(45deg,#00ffcc,#00d6b8); color:#000; font-weight:bold; cursor:pointer;}
    button:hover { background:linear-gradient(45deg,#00d6b8,#00bfa0); }
    .notification { margin-top:15px; padding:10px; border-radius:8px; display:none; font-size:0.9rem;}
    .notification.error { background:#ff4444; color:#fff;}
    .notification.success { background:#4CAF50; color:#fff;}
</style>
</head>
<body>

<div class="login-container">
    <h1>G3 Cloud</h1>
    <p class="slogan">Sistema confiável de gerenciamento comercial</p>

    <input type="text" id="username" placeholder="Usuário">
    <input type="password" id="password" placeholder="Senha">
    <button onclick="login()">Entrar</button>

    <div id="notification" class="notification"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.27.0/dist/supabase.min.js"></script>
<script>
const SUPABASE_URL = 'https://fobmjibfbbzlnnnmtsct.supabase.co';
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZvYm1qaWJmYmJ6bG5ubm10c2N0Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1NDc3ODg1NCwiZXhwIjoyMDcwMzU0ODU0fQ.05CmzJ0kuOOmW9GJr0PEQ8eGiNzGbgZhiCBgBXczo_Y';
const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

const notif = document.getElementById('notification');

function showNotification(message, type='error'){
    notif.textContent = message;
    notif.className = `notification ${type}`;
    notif.style.display = 'block';
    setTimeout(()=>{ notif.style.display='none'; }, 4000);
}

async function login() {
    const username = document.getElementById('username').value.trim();
    const password = document.getElementById('password').value.trim();

    if(!username || !password){
        showNotification('Preencha usuário e senha!', 'error');
        return;
    }

    try {
        const { data, error } = await supabase
            .from('users')
            .select('*')
            .eq('username', username);

        if(error){
            console.error('Erro Supabase:', error);
            showNotification('Erro ao acessar o banco de dados!', 'error');
            return;
        }

        console.log('Dados retornados:', data);

        if(!data || data.length === 0){
            showNotification('Usuário não encontrado!', 'error');
            return;
        }

        const user = data[0];
        if(user.password !== password){
            showNotification('Senha incorreta!', 'error');
            return;
        }

        // Tudo certo, login OK
        showNotification('Login efetuado com sucesso!', 'success');
        setTimeout(()=>{ window.location.href = 'g3cloud.html'; }, 1000);

    } catch(err){
        console.error('Erro:', err);
        showNotification('Erro ao processar login!', 'error');
    }
}
</script>

</body>
</html>